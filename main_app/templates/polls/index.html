{% extends 'base.html' %}
{% load static %}

{% block head %}
<link 
  rel="stylesheet"
  type="text/css"
  href="{% static 'css/polls/poll-index.css' %}"
/>
{% endblock %}

{% block content %}

  <div class="container main-container mt-5">
    <section class="page-header">
      <h1>Available Polls</h1>
    </section>

    <section class="card-container">
      {% for poll in public_polls %}
        <div class="card">
          <a href="{% url 'polls_detail' poll.id %}">
            <div class="card-content">
              <h2 class="card-title">{{ poll.title }}</h2>
              {% if poll.notes %}
              <p>{{ poll.notes }}</p>
              {% endif %}
            </div>
          </a>
        </div>
      {% endfor %}
    </section>

    {% if user.is_authenticated %}
      <section class="page-header">
        <h1>Your Polls</h1>
      </section>
      <section class="card-container">
        {% for poll in user_polls %}
          <div class="card">
            <a href="{% url 'polls_detail' poll.id %}">
              <div class="card-content">
                <h2 class="card-title">{{ poll.title }}</h2>
                {% if poll.notes %}
                <p>{{ poll.notes }}</p>
                {% endif %}
              </div>
            </a>
          </div>
        {% endfor %}
      </section>
    {% endif %}

    <p>
      <button class="btn collapse-btn" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-expired" aria-expanded="false" aria-controls="collapse-expired">
        Show Closed Polls
      </button>
    </p>
    <div class="collapse" id="collapse-expired">
      <ul class="list-group">
        {% for poll in expired_polls %}
          <li class="list-group-item d-flex justify-content-between align-items-start">
            <a href="{% url 'polls_detail' poll.id %}">
              <div class="ms-2 me-auto">
                <h3>{{ poll.title }}</h3>
                <h4>{{ poll.notes }}</h4>
                <h4>Closes ~ {{ poll.expires|timeuntil }}</h4>
              </div>
            </a>
          </li>
        {% endfor %}
      </ul>
    </div>
  </div>

{% endblock %}